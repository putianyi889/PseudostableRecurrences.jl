<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · PseudostableRecurrences</title><meta name="title" content="Examples · PseudostableRecurrences"/><meta property="og:title" content="Examples · PseudostableRecurrences"/><meta property="twitter:title" content="Examples · PseudostableRecurrences"/><meta name="description" content="Documentation for PseudostableRecurrences."/><meta property="og:description" content="Documentation for PseudostableRecurrences."/><meta property="twitter:description" content="Documentation for PseudostableRecurrences."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">PseudostableRecurrences</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">PseudostableRecurrences.jl</a></li><li><a class="tocitem" href="../docstrings/">Docstrings</a></li><li class="is-active"><a class="tocitem" href>Examples</a><ul class="internal"><li><a class="tocitem" href="#Linear-recursive-Sequence"><span>Linear-recursive Sequence</span></a></li><li><a class="tocitem" href="#Special-integrals"><span>Special integrals</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/putianyi889/PseudostableRecurrences.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/putianyi889/PseudostableRecurrences.jl/blob/master/docs/src/examples.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h1><h2 id="Linear-recursive-Sequence"><a class="docs-heading-anchor" href="#Linear-recursive-Sequence">Linear-recursive Sequence</a><a id="Linear-recursive-Sequence-1"></a><a class="docs-heading-anchor-permalink" href="#Linear-recursive-Sequence" title="Permalink"></a></h2><p>Consider the recurrence</p><p class="math-container">\[x_1=x_2=x_3=\sqrt{2}, x_{n+3}-\frac{10}{3}x_{n+2}+3x_{n+1}-\frac{2}{3}x_n=0.\]</p><p>First, we shall recognise that the linear recursive sequence is basically a 1D stencil recurrence. The recurrence needs to be converted to an assignment first, that is, <span>$x_{n}=\frac{10}{3}x_{n-1}-3x_{n-2}+\frac{2}{3}x_{n-3}$</span>. Such a recurrence can be defined by the stencil with the coefficients</p><pre><code class="language-julia hljs">stencil = (CartesianIndex(-3), CartesianIndex(-2), CartesianIndex(-1))
coefs = (n -&gt; 2//3, n -&gt; -3, n -&gt; 10//3)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(Main.var&quot;#1#4&quot;(), Main.var&quot;#2#5&quot;(), Main.var&quot;#3#6&quot;())</code></pre><div class="admonition is-info"><header class="admonition-header">Inhomogeneous case</header><div class="admonition-body"><p>To define a linear inhomogeneous recurrence, the coefficient associated with the zero cartesian index is used. For example, the recurrence</p><p class="math-container">\[x_{n}=\frac{10}{3}x_{n-1}-3x_{n-2}+\frac{2}{3}x_{n-3}+\frac{1}{n}\]</p><p>should be defined by</p><pre><code class="language-julia hljs">stencil = (CartesianIndex(-3), CartesianIndex(-2), CartesianIndex(-1), CartesianIndex(0))
coefs = (n -&gt; 2//3, n -&gt; -3, n -&gt; 10//3, n -&gt; 1//n)</code></pre></div></div><p>We then need to define the initial values</p><pre><code class="language-julia hljs">f_init(T) = [sqrt(T(2)), sqrt(T(2)), sqrt(T(2)), T(0)]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">f_init (generic function with 1 method)</code></pre><p>where the place for the next step should be reserved. This is a function that can generate values based on type <code>T</code>.</p><p>Now we only need to further provide the size of the recurrence and we are ready to go.</p><pre><code class="language-julia hljs">P = StencilRecurrencePlan{Real}(stencil, coefs, f_init, (100,)) # &#39;Real&#39; specifies the domain of the entries, as opposed to &#39;Complex&#39;, etc.
stable_recurrence(P) # defaults to stable_recurrence(P, Float64)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">100-element Vector{Float64}:
 1.4142135623730951
 1.4142135623730951
 1.4142135623730951
 1.4142135623730951
 1.4142135623730951
 1.4142135623730951
 1.4142135623730951
 1.4142135623730951
 1.4142135623730951
 1.4142135623730951
 ⋮
 1.4142135623730951
 1.4142135623730951
 1.4142135623730951
 1.4142135623730951
 1.4142135623730951
 1.4142135623730951
 1.4142135623730951
 1.4142135623730951
 1.4142135623730951</code></pre><h2 id="Special-integrals"><a class="docs-heading-anchor" href="#Special-integrals">Special integrals</a><a id="Special-integrals-1"></a><a class="docs-heading-anchor-permalink" href="#Special-integrals" title="Permalink"></a></h2><p>Consider the integral</p><p class="math-container">\[I(m,n) = \int_0^\pi\left(\frac{\cos x}{1+\sin x}\right)^me^{inx}\mathrm{d}x\]</p><p>which has the recurrence</p><p class="math-container">\[I(m,n)=\begin{cases}
    2i/n,&amp; m=0, n\text{ odd}\\
    \displaystyle(-1)^{m/2}\left(\pi-4\sum_{k=1}^{m/2}\frac{(-1)^k}{2k-1}\right),&amp; m\text{ even}, n=0\\
    0,&amp; \!\!\!\begin{array}{l}
        m=0\text{ or }n=0,\\
        \text{excluding above cases}
    \end{array}\\
    \displaystyle\frac{m+n-1}{ni}I(m,n-1)+\frac{m}{n}I(m-1,n-1)+\frac{2}{n}\begin{cases}
        i,\\
        -1,
    \end{cases}&amp;\!\!\!\begin{array}{l}
        m+n\text{ odd}\\
        m+n\text{ even}.
    \end{array}
\end{cases}\]</p><p>Our goal is to obtain the numerical integrals for a range of <span>$m$</span> and <span>$n$</span>. We may use a matrix to store the results, with <code>m+1</code> and <code>n+1</code> being the row and column indices.</p><p>The problem is again a stencil recurrence, where</p><pre><code class="language-julia hljs">stencil = (CartesianIndex(-1,-1), CartesianIndex(0,-1), CartesianIndex(0,0))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(CartesianIndex(-1, -1), CartesianIndex(0, -1), CartesianIndex(0, 0))</code></pre><p>and</p><pre><code class="language-julia hljs">coef1(m,n) = (m-1)//(n-1)
coef2(m,n) = (m+n-3)//(n-1)//im
coef3(m,n) = 2//(n-1)*ifelse(isodd(m+n), im, -1)
coef = (coef1, coef2, coef3)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(Main.coef1, Main.coef2, Main.coef3)</code></pre><p>Note that Julia indices starts at 1, hence the <code>m-1</code>, <code>n-1</code>, etc.. Recall that the <code>CartesianIndex(0,0)</code> and <code>coef3</code> corresponds to the inhomogeneous term <span>$\displaystyle\frac{2}{n}\begin{cases}i, &amp; m+n\text{ odd}\\ -1, &amp; m+n\text{ even}\end{cases}$</span>.</p><p>We need to initialise the first column as well.</p><pre><code class="language-julia hljs">function f_init(T, m)
    A = zeros(Complex{T},m,2)
    A[1,1] = π
    for mm in 3:2:m
        A[mm,1] = -A[mm-2,1] + 4//(mm-2)
    end
    A
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">f_init (generic function with 1 method)</code></pre><p>Here, <code>m</code> specifies the size of the first dimension. For an <span>$n$</span>-dimensional stencil recurrence, each slice has <span>$n-1$</span> dimensions, so the initialization function has to take <span>$n-1$</span> size arguments.</p><div class="admonition is-info"><header class="admonition-header">Initialising the first row</header><div class="admonition-body"><p><code>PseudostableRecurrences.jl</code> doesn&#39;t support initialising the first row in the backend. However, if a stencil exceeds the boundary, the external entries will be ignored. This allows one to modify the coefficients to achieve the initialization of the first row. In this example, the recurrence happens to initialise the first row correctly, so there is no need to modify it.</p></div></div><p>Then we are ready to run the recurrence.</p><pre><code class="language-julia hljs">P = StencilRecurrencePlan{Complex}(stencil, coef, f_init, (101,101), (1,2))
ret = hcat(stable_recurrence(P)...)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">101×101 Matrix{ComplexF64}:
   3.14159+0.0im        0.0+2.0im          …  -6.90341e-92+0.0im
       0.0+0.0im    1.14159+0.0im                      0.0+0.019998im
  0.858407-0.0im        0.0+0.283185im           0.0003998+0.0im
       0.0+0.0im   0.575222+0.0im                      0.0+0.019982im
  0.474926+0.0im        0.0+0.100296im         0.000798643+0.0im
       0.0+0.0im    0.37463+0.0im          …           0.0+0.0199501im
  0.325074-0.0im        0.0+0.0495559im         0.00119558+0.0im
       0.0+0.0im   0.275518+0.0im                      0.0+0.0199025im
  0.246355+0.0im        0.0+0.0291635im         0.00158968+0.0im
       0.0+0.0im   0.217191+0.0im                      0.0+0.0198394im
          ⋮                                ⋱              ⋮
 0.0217366+0.0im        0.0+0.000236156im       0.00996587+0.0im
       0.0+0.0im  0.0215004+0.0im                      0.0+0.0107245im
 0.0212742-0.0im        0.0+0.000226219im       0.00998141+0.0im
       0.0+0.0im   0.021048+0.0im          …           0.0+0.0105125im
 0.0208311+0.0im        0.0+0.000216896im       0.00999219+0.0im
       0.0+0.0im  0.0206142+0.0im                      0.0+0.0103045im
  0.020406-0.0im        0.0+0.000208138im       0.00999847+0.0im
       0.0+0.0im  0.0201979+0.0im                      0.0+0.0101005im
  0.019998+0.0im        0.0+0.0001999im    …     0.0100005+0.0im</code></pre><p>By design, <code>stable_recurrence</code> returns a vector of slices, so <code>hcat</code> is used to re-assemble the result. The last argument of <code>StencilRecurrencePlan</code> specifies the index where the recurrence starts at. By default, it will start from where the stencil doesn&#39;t go out of bound. In this example, however, we do want to apply the stencil to the first row in order to initialise it.</p><p>Now we compare the results against that from <a href="https://github.com/JuliaMath/QuadGK.jl"><code>QuadGK.jl</code></a> to verify the correctness:</p><pre><code class="language-julia hljs">maximum(abs, ret[92:end, 92:end] - [quadgk(x-&gt;(cos(x)/(1+sin(x)))^m*exp(im*n*x), 0, π)[1] for m in 91:100, n in 91:100])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2.720046963495951e-16</code></pre><div class="admonition is-info"><header class="admonition-header">Performance</header><div class="admonition-body"><p>The recurrence is faster than generic numerical integration when the intermediate results are useful. In this example, when <code>m</code> is small and <code>n</code> is large, the function is oscillatory which <code>QuadGK.jl</code> has difficulty to handle:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; @btime quadgk(x-&gt;(cos(x)/(1+sin(x)))^100*exp(im*100*x), 0, π);</code><code class="nohighlight hljs ansi" style="display:block;">  19.897 μs (3 allocations: 2.19 KiB)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; @btime quadgk(x-&gt;(cos(x)/(1+sin(x)))^2*exp(im*100*x), 0, π);</code><code class="nohighlight hljs ansi" style="display:block;">  118.702 μs (4 allocations: 9.06 KiB)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; @btime quadgk(x-&gt;exp(im*100*x), 0, π);</code><code class="nohighlight hljs ansi" style="display:block;">  264.850 ms (13 allocations: 23.76 MiB)</code></pre><p>This is why we don&#39;t compare the whole matrix.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../docstrings/">« Docstrings</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Thursday 29 February 2024 17:08">Thursday 29 February 2024</span>. Using Julia version 1.10.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
